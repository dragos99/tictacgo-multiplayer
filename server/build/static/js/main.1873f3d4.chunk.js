(this["webpackJsonptictacgo-multiplayer"]=this["webpackJsonptictacgo-multiplayer"]||[]).push([[0],{100:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n(0),r=n.n(i),s=n(54),l=n.n(s),o=(n(64),n(65),n(36)),c=n(2);var u=function(){var e=Object(c.f)(),t=Object(i.useState)(null),n=Object(o.a)(t,2),r=n[0],s=n[1],l=Object(i.useState)(!1),u=Object(o.a)(l,2),h=u[0],d=u[1];return null===r&&localStorage.getItem("username")&&s(localStorage.getItem("username")),Object(a.jsxs)("div",{id:"create-game-container",children:[Object(a.jsx)("input",{className:"text-field",disabled:h,type:"text",onChange:function(e){s(e.target.value)},placeholder:"Username",value:r}),Object(a.jsx)("button",{className:"big-button",disabled:h,id:"create-game-button",onClick:function(){h||r&&(localStorage.setItem("username",r),d(!0),fetch("/createGame",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:r})}).then((function(e){return e.json()})).then((function(t){e.push({pathname:"/".concat(t.gameId),state:{username:r}})})))},children:"Create game"})]})},h=n(33),d=n(12),m=n(15),f=n(16),b=n(58),v=n(57),g=(n(39),n(56)),p=n.n(g);var j=function(e){var t=e.data,n=(t.boxId,t.taken),i="box";return"X"===n?i+=" x-taken":"0"===n&&(i+=" o-taken"),Object(a.jsxs)("div",{className:i,children:[!n&&e.children,n||null]})};var k=function(e){var t=e.data,n=t.boxId,i=t.cellId,r=t.taken,s=t.availableTo,l=t.lastMove,o="cell";return"X"===r?o+=" x-taken":"0"===r&&(o+=" o-taken"),"X"===s||"X"===l?o+=" x-available":"0"!==s&&"0"!==l||(o+=" o-available"),Object(a.jsx)("div",{className:o,onClick:function(){!r&&s&&e.takeCell(n,i)},children:r})};var w=function(e){return Object(a.jsx)("div",{id:"board",children:e.board.map((function(t,n){return Object(a.jsx)(j,{data:t,children:t.cells.map((function(t,n){return Object(a.jsx)(k,{data:t,takeCell:e.takeCell},n)}))},n)}))})},y=function(){function e(t,n){Object(m.a)(this,e),this.boxId=t,this.cellId=n,this.taken="",this.availableTo=null,this.lastMove=null}return Object(f.a)(e,[{key:"take",value:function(e){this.taken=e}}]),e}();function x(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t[0].taken)return!1;for(var a=1;a<t.length;++a)if(t[a].taken!==t[0].taken)return!1;return!0}var O=function(){function e(t){Object(m.a)(this,e),this.boxId=t,this.cells=[],this.taken=null,this.setupCells()}return Object(f.a)(e,[{key:"setupCells",value:function(){for(var e=0;e<9;++e)this.cells.push(new y(this.boxId,e))}},{key:"takeCell",value:function(e,t){this.cells[e].take(t),this.taken=this.getOwner()}},{key:"setAvailable",value:function(e){if(!this.taken){var t,n=Object(d.a)(this.cells);try{for(n.s();!(t=n.n()).done;){var a=t.value;a.taken&&e||(a.availableTo=e)}}catch(i){n.e(i)}finally{n.f()}}}},{key:"getOwner",value:function(){for(var e=0;e<3;++e)if(x(this.cells[3*e],this.cells[3*e+1],this.cells[3*e+2]))return this.cells[3*e].taken;for(var t=0;t<3;++t)if(x(this.cells[t],this.cells[t+3],this.cells[t+6]))return this.cells[t].taken;return x(this.cells[0],this.cells[4],this.cells[8])||x(this.cells[2],this.cells[4],this.cells[6])?this.cells[4].taken:null}}]),e}(),C={maxCount:150,speed:2,frameInterval:15,alpha:1,gradient:!1,start:null,stop:null,toggle:null,pause:null,resume:null,togglePause:null,remove:null,isPaused:null,isRunning:null};!function(){C.start=d,C.stop=m,C.toggle=function(){n?m():d()},C.pause=c,C.resume=u,C.togglePause=function(){a?u():c()},C.isPaused=function(){return a},C.remove=function(){window.stop(),a=!1,r=[]},C.isRunning=function(){return n};var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,t=["rgba(30,144,255,","rgba(107,142,35,","rgba(255,215,0,","rgba(255,192,203,","rgba(106,90,205,","rgba(173,216,230,","rgba(238,130,238,","rgba(152,251,152,","rgba(70,130,180,","rgba(244,164,96,","rgba(210,105,30,","rgba(220,20,60,"],n=!1,a=!1,i=Date.now(),r=[],s=0,l=null;function o(e,n,a){return e.color=t[Math.random()*t.length|0]+(C.alpha+")"),e.color2=t[Math.random()*t.length|0]+(C.alpha+")"),e.x=Math.random()*n,e.y=Math.random()*a-a,e.diameter=10*Math.random()+5,e.tilt=10*Math.random()-10,e.tiltAngleIncrement=.07*Math.random()+.05,e.tiltAngle=Math.random()*Math.PI,e}function c(){a=!0}function u(){a=!1,h()}function h(){if(!a)if(0===r.length)l.clearRect(0,0,window.innerWidth,window.innerHeight),null;else{var t=Date.now(),c=t-i;(!e||c>C.frameInterval)&&(l.clearRect(0,0,window.innerWidth,window.innerHeight),function(){var e,t=window.innerWidth,a=window.innerHeight;s+=.01;for(var i=0;i<r.length;i++)e=r[i],!n&&e.y<-15?e.y=a+100:(e.tiltAngle+=e.tiltAngleIncrement,e.x+=Math.sin(s)-.5,e.y+=.5*(Math.cos(s)+e.diameter+C.speed),e.tilt=15*Math.sin(e.tiltAngle)),(e.x>t+20||e.x<-20||e.y>a)&&(n&&r.length<=C.maxCount?o(e,t,a):(r.splice(i,1),i--))}(),function(e){for(var t,n,a,i,s=0;s<r.length;s++){if(t=r[s],e.beginPath(),e.lineWidth=t.diameter,n=(a=t.x+t.tilt)+t.diameter/2,i=t.y+t.tilt+t.diameter/2,C.gradient){var l=e.createLinearGradient(n,t.y,a,i);l.addColorStop("0",t.color),l.addColorStop("1.0",t.color2),e.strokeStyle=l}else e.strokeStyle=t.color;e.moveTo(n,t.y),e.lineTo(a,i),e.stroke()}}(l),i=t-c%C.frameInterval),requestAnimationFrame(h)}}function d(e,t,i){var s=window.innerWidth,c=window.innerHeight;window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,C.frameInterval)};var u=document.getElementById("confetti-canvas");null===u?((u=document.createElement("canvas")).setAttribute("id","confetti-canvas"),u.setAttribute("style","display:block;z-index:999999;pointer-events:none;position:fixed;top:0"),document.body.prepend(u),u.width=s,u.height=c,window.addEventListener("resize",(function(){u.width=window.innerWidth,u.height=window.innerHeight}),!0),l=u.getContext("2d")):null===l&&(l=u.getContext("2d"));var d=C.maxCount;if(t)if(i)if(t==i)d=r.length+i;else{if(t>i){var f=t;t=i,i=f}d=r.length+(Math.random()*(i-t)+t|0)}else d=r.length+t;else i&&(d=r.length+i);for(;r.length<d;)r.push(o({},s,c));n=!0,a=!1,h(),e&&window.setTimeout(m,e)}function m(){n=!1}}();var I=C,M="Connecting",S="Choose a username",A="Joining game",N="Waiting for opponent",P="Playing",F=function(e){Object(b.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={username:"",opponentUsername:"",gameState:M,winner:null},e.socket=null,e.board=null,e.me=null,e.currentPlayer="X",e.lastMove=null,e.changeUsername=function(t){e.setState({username:t.target.value})},e.setUsername=function(){var t=e.props.location;if(t.state&&t.state.username)e.setState({username:t.state.username},e.joinGame);else{var n=localStorage.getItem("username");e.setState({username:n,gameState:S})}},e.joinGame=function(){localStorage.setItem("username",e.state.username),e.setState({gameState:A},(function(){var t=e.props.location.pathname.substr(1),n=e.state.username;e.socket.emit("joinGame",{gameId:t,username:n})}))},e.takeCell=function(t,n){e.currentPlayer===e.me&&(e.socket.emit("takeCell",{boxId:t,cellId:n,player:e.me}),e.applyMove(t,n,e.me))},e.applyMove=function(t,n,a){e.board[t].takeCell(n,a),e.currentPlayer=e.otherPlayer(a),e.lastMove={boxId:t,cellId:n,player:a},e.checkWin(),e.updateAvailableCells(),e.updateLastMove(),e.forceUpdate()},e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.socket=p()(),this.socket.on("connect",(function(){e.setUsername()})),this.socket.on("joinGame",(function(t){t.success&&e.setState({gameState:N})})),this.socket.on("player",(function(t){e.me=t})),this.socket.on("opponent",(function(t){e.setState({opponentUsername:t})})),this.socket.on("startGame",(function(){e.setState({gameState:P})})),this.socket.on("takeCell",(function(t){e.applyMove(t.boxId,t.cellId,t.player)})),this.setupBoard()}},{key:"setupBoard",value:function(){this.board=[];for(var e=0;e<9;++e)this.board.push(new O(e));this.updateAvailableCells()}},{key:"updateAvailableCells",value:function(){var e,t=Object(d.a)(this.board);try{for(t.s();!(e=t.n()).done;){e.value.setAvailable(null)}}catch(r){t.e(r)}finally{t.f()}if(!this.getWinner()){var n=null;if(this.lastMove&&(n=this.board[this.lastMove.cellId]),!n||n.taken){var a,i=Object(d.a)(this.board);try{for(i.s();!(a=i.n()).done;){a.value.setAvailable(this.currentPlayer)}}catch(r){i.e(r)}finally{i.f()}}else n.setAvailable(this.currentPlayer)}}},{key:"updateLastMove",value:function(){var e,t=Object(d.a)(this.board);try{for(t.s();!(e=t.n()).done;){var n,a=e.value,i=Object(d.a)(a.cells);try{for(i.s();!(n=i.n()).done;){n.value.lastMove=null}}catch(r){i.e(r)}finally{i.f()}}}catch(r){t.e(r)}finally{t.f()}this.board[this.lastMove.boxId].cells[this.lastMove.cellId].lastMove=this.lastMove.player}},{key:"checkWin",value:function(){var e=this.getWinner();e&&(this.setState({winner:e}),I.start(),setTimeout(I.stop,1500))}},{key:"getWinner",value:function(){for(var e=0;e<3;++e)if(U(this.board[3*e],this.board[3*e+1],this.board[3*e+2]))return this.board[3*e].taken;for(var t=0;t<3;++t)if(U(this.board[t],this.board[t+3],this.board[t+6]))return this.board[t].taken;return U(this.board[0],this.board[4],this.board[8])||U(this.board[2],this.board[4],this.board[6])?this.board[4].taken:null}},{key:"otherPlayer",value:function(e){return"X"===e?"0":"X"}},{key:"getUsernameOf",value:function(e){return this.me===e?this.state.username:this.state.opponentUsername}},{key:"headerContent",value:function(){return"X"===this.state.winner?Object(a.jsxs)("div",{className:"playerName x",children:[this.getUsernameOf(this.state.winner)," won !!!"]}):"0"===this.state.winner?Object(a.jsxs)("div",{className:"playerName o",children:[this.getUsernameOf(this.state.winner)," won !!!"]}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"playerName x",children:this.getUsernameOf("X")}),Object(a.jsx)("div",{className:"versus",children:"vs"}),Object(a.jsx)("div",{className:"playerName o",children:this.getUsernameOf("0")})]})}},{key:"render",value:function(){return this.state.gameState===S?Object(a.jsxs)("div",{id:"create-game-container",children:[Object(a.jsx)("input",{className:"text-field",type:"text",onChange:this.changeUsername,placeholder:"Username",value:this.state.username}),Object(a.jsx)("button",{className:"big-button",id:"join-game-button",onClick:this.joinGame,children:"Join game"})]}):this.state.gameState===N?Object(a.jsxs)("div",{className:"game-modal",children:[Object(a.jsx)("div",{className:"waiting-for-opponent",children:"Waiting for opponent..."}),Object(a.jsx)("div",{className:"give-link",children:"Give your friend this link:"}),Object(a.jsx)("div",{className:"game-link",children:window.location.href})]}):this.state.gameState===P?Object(a.jsxs)("div",{id:"game",children:[Object(a.jsx)("div",{id:"header",children:this.headerContent()}),Object(a.jsx)(w,{board:this.board,currentPlayer:this.currentPlayer,takeCell:this.takeCell,winner:this.state.winner})]}):null}}]),n}(r.a.Component);function U(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t[0].taken)return!1;for(var a=1;a<t.length;++a)if(t[a].taken!==t[0].taken)return!1;return!0}var W=Object(c.g)(F);var q=function(){return Object(a.jsx)(h.a,{children:Object(a.jsxs)(c.c,{children:[Object(a.jsx)(c.a,{path:"/:id",children:Object(a.jsx)(W,{})}),Object(a.jsx)(c.a,{path:"/",children:Object(a.jsx)(u,{})})]})})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,101)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),i(e),r(e),s(e)}))};l.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(q,{})}),document.getElementById("root")),R()},39:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){}},[[100,1,2]]]);
//# sourceMappingURL=main.1873f3d4.chunk.js.map