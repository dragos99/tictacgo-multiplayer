(this["webpackJsonptictacgo-multiplayer"]=this["webpackJsonptictacgo-multiplayer"]||[]).push([[0],{100:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a(0),s=a.n(l),i=a(54),c=a.n(i),r=(a(64),a(65),a(36)),o=a(2);var u=function(){var e=Object(o.f)(),t=Object(l.useState)(""),a=Object(r.a)(t,2),s=a[0],i=a[1],c=Object(l.useState)(!1),u=Object(r.a)(c,2),h=u[0],d=u[1];return Object(n.jsxs)("div",{id:"create-game-container",children:[Object(n.jsx)("input",{className:"text-field",disabled:h,type:"text",onChange:function(e){i(e.target.value)},placeholder:"Username"}),Object(n.jsx)("button",{className:"big-button",disabled:h,id:"create-game-button",onClick:function(){h||s&&(d(!0),fetch("/createGame",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s})}).then((function(e){return e.json()})).then((function(t){e.push({pathname:"/".concat(t.gameId),state:{username:s}})})))},children:"Create game"})]})},h=a(23),d=a(12),b=a(15),v=a(16),f=a(58),j=a(57),m=(a(39),a(56)),p=a.n(m);var k=function(e){var t=e.data,a=(t.boxId,t.taken),l="box";return"X"===a?l+=" x-taken":"0"===a&&(l+=" o-taken"),Object(n.jsxs)("div",{className:l,children:[!a&&e.children,a||null]})};var y=function(e){var t=e.data,a=t.boxId,l=t.cellId,s=t.taken,i=t.availableTo,c=t.lastMove,r="cell";return"X"===s?r+=" x-taken":"0"===s&&(r+=" o-taken"),"X"===i||"X"===c?r+=" x-available":"0"!==i&&"0"!==c||(r+=" o-available"),Object(n.jsx)("div",{className:r,onClick:function(){!s&&i&&e.takeCell(a,l)},children:s})};var O=function(e){return Object(n.jsx)("div",{id:"board",children:e.board.map((function(t,a){return Object(n.jsx)(k,{data:t,children:t.cells.map((function(t,a){return Object(n.jsx)(y,{data:t,takeCell:e.takeCell},a)}))},a)}))})},g=function(){function e(t,a){Object(b.a)(this,e),this.boxId=t,this.cellId=a,this.taken="",this.availableTo=null,this.lastMove=null}return Object(v.a)(e,[{key:"take",value:function(e){this.taken=e}}]),e}();function x(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];if(!t[0].taken)return!1;for(var n=1;n<t.length;++n)if(t[n].taken!==t[0].taken)return!1;return!0}var C=function(){function e(t){Object(b.a)(this,e),this.boxId=t,this.cells=[],this.taken=null,this.setupCells()}return Object(v.a)(e,[{key:"setupCells",value:function(){for(var e=0;e<9;++e)this.cells.push(new g(this.boxId,e))}},{key:"takeCell",value:function(e,t){this.cells[e].take(t),this.taken=this.getOwner()}},{key:"setAvailable",value:function(e){if(!this.taken){var t,a=Object(d.a)(this.cells);try{for(a.s();!(t=a.n()).done;){var n=t.value;n.taken&&e||(n.availableTo=e)}}catch(l){a.e(l)}finally{a.f()}}}},{key:"getOwner",value:function(){for(var e=0;e<3;++e)if(x(this.cells[3*e],this.cells[3*e+1],this.cells[3*e+2]))return this.cells[3*e].taken;for(var t=0;t<3;++t)if(x(this.cells[t],this.cells[t+3],this.cells[t+6]))return this.cells[t].taken;return x(this.cells[0],this.cells[4],this.cells[8])||x(this.cells[2],this.cells[4],this.cells[6])?this.cells[4].taken:null}}]),e}(),I="Connecting",S="Choose a username",M="Joining game",N="Waiting for opponent",P="Playing",w=function(e){Object(f.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return(e=t.call.apply(t,[this].concat(l))).state={username:"",gameState:I},e.socket=null,e.board=null,e.me=null,e.currentPlayer="X",e.lastMove=null,e.changeUsername=function(t){e.setState({username:t.target.value})},e.setUsername=function(){var t=e.props.location;t.state&&t.state.username?e.setState({username:t.state.username},e.joinGame):e.setState({gameState:S})},e.joinGame=function(){e.setState({gameState:M},(function(){var t=e.props.location.pathname.substr(1),a=e.state.username;e.socket.emit("joinGame",{gameId:t,username:a})}))},e.takeCell=function(t,a){e.currentPlayer===e.me&&(e.socket.emit("takeCell",{boxId:t,cellId:a,player:e.me}),e.applyMove(t,a,e.me))},e.applyMove=function(t,a,n){e.board[t].takeCell(a,n),e.currentPlayer=e.otherPlayer(n),e.lastMove={boxId:t,cellId:a,player:n},e.updateAvailableCells(),e.updateLastMove(),e.forceUpdate()},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.socket=p()(),this.socket.on("connect",(function(){e.setUsername()})),this.socket.on("joinGame",(function(t){t.success&&e.setState({gameState:N})})),this.socket.on("player",(function(t){e.me=t})),this.socket.on("startGame",(function(){e.setState({gameState:P})})),this.socket.on("takeCell",(function(t){e.applyMove(t.boxId,t.cellId,t.player)})),this.setupBoard()}},{key:"setupBoard",value:function(){this.board=[];for(var e=0;e<9;++e)this.board.push(new C(e));this.updateAvailableCells()}},{key:"updateAvailableCells",value:function(){var e,t=Object(d.a)(this.board);try{for(t.s();!(e=t.n()).done;){e.value.setAvailable(null)}}catch(s){t.e(s)}finally{t.f()}var a=null;if(this.lastMove&&(a=this.board[this.lastMove.cellId]),!a||a.taken){var n,l=Object(d.a)(this.board);try{for(l.s();!(n=l.n()).done;){n.value.setAvailable(this.currentPlayer)}}catch(s){l.e(s)}finally{l.f()}}else a.setAvailable(this.currentPlayer)}},{key:"updateLastMove",value:function(){var e,t=Object(d.a)(this.board);try{for(t.s();!(e=t.n()).done;){var a,n=e.value,l=Object(d.a)(n.cells);try{for(l.s();!(a=l.n()).done;){a.value.lastMove=null}}catch(s){l.e(s)}finally{l.f()}}}catch(s){t.e(s)}finally{t.f()}this.board[this.lastMove.boxId].cells[this.lastMove.cellId].lastMove=this.lastMove.player}},{key:"otherPlayer",value:function(e){return"X"===e?"0":"X"}},{key:"render",value:function(){return this.state.gameState===S?Object(n.jsxs)("div",{id:"create-game-container",children:[Object(n.jsx)("input",{className:"text-field",type:"text",onChange:this.changeUsername,placeholder:"Username"}),Object(n.jsx)("button",{className:"big-button",id:"join-game-button",onClick:this.joinGame,children:"Join game"})]}):this.state.gameState===P?Object(n.jsxs)("div",{id:"game",children:[Object(n.jsxs)("div",{id:"header",children:[Object(n.jsx)("div",{className:"playerName x",children:"smokie"}),Object(n.jsx)("div",{className:"versus",children:"vs"}),Object(n.jsx)("div",{className:"playerName o",children:"Meh"})]}),Object(n.jsx)(O,{board:this.board,currentPlayer:this.currentPlayer,takeCell:this.takeCell})]}):this.state.gameState===N?Object(n.jsxs)("div",{className:"game-modal",children:[Object(n.jsx)("div",{className:"waiting-for-opponent",children:"Waiting for opponent..."}),Object(n.jsx)("div",{className:"give-link",children:"Give your friend this link:"}),Object(n.jsx)("div",{className:"game-link",children:window.location.href})]}):null}}]),a}(s.a.Component),A=Object(o.g)(w);var G=function(){return Object(n.jsx)(h.a,{children:Object(n.jsxs)(o.c,{children:[Object(n.jsx)(o.a,{path:"/:id",children:Object(n.jsx)(A,{})}),Object(n.jsx)(o.a,{path:"/",children:Object(n.jsx)(u,{})})]})})},T=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,101)).then((function(t){var a=t.getCLS,n=t.getFID,l=t.getFCP,s=t.getLCP,i=t.getTTFB;a(e),n(e),l(e),s(e),i(e)}))};c.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(G,{})}),document.getElementById("root")),T()},39:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){}},[[100,1,2]]]);
//# sourceMappingURL=main.e4974d28.chunk.js.map